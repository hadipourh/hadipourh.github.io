---
import { Image } from 'astro:assets'
import {profile} from '../../settings'
import SocialIcons from './SocialIcons.astro'
import { getCollection } from 'astro:content'
import { template } from '@/settings'

const isBlogPopulated = await getCollection('blog').then(collection => collection.length > 0)

const {fullName, title} = profile
// Use the uploaded professional profile picture for navbar
const profilePicture = '/images/profilepic2.png'

// Navigation items with icons
const navigationItems = [
	{ href: `${template.base}/`, label: 'Home', icon: 'M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6' },
	{ href: `${template.base}/papers`, label: 'Publications', icon: 'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z' },
	{ href: `${template.base}/projects`, label: 'Projects', icon: 'M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z' },
	{ href: `${template.base}/teaching`, label: 'Teaching', icon: 'M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253' },
	...(isBlogPopulated ? [{ href: `${template.base}/blog/1`, label: 'Blog', icon: 'M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z' }] : []),
	{ href: `${template.base}/talks`, label: 'Talks', icon: 'M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2m0 0V1a1 1 0 011-1h2a1 1 0 011 1v18a1 1 0 01-1 1H3a1 1 0 01-1-1V1a1 1 0 011-1h2a1 1 0 011 1v3m0 0h8m-8 0H5a1 1 0 00-1 1v14a1 1 0 001 1h14a1 1 0 001-1V5a1 1 0 00-1-1h-2m-8 0V4' },
	{ href: `${template.base}/cv`, label: 'CV', icon: 'M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z' },
	{ href: `${template.base}/contact`, label: 'Contact', icon: 'M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z' }
]
---
<aside
	class='px-6 pt-6 h-screen w-[20rem] bg-gradient-to-b from-base-200 via-base-200/95 to-base-300/90 backdrop-blur-sm text-base-content flex flex-col relative overflow-hidden'
>
	<!-- Subtle animated background pattern -->
	<div class="absolute inset-0 bg-gradient-to-br from-primary/5 via-secondary/5 to-accent/5 animate-pulse"></div>
	<div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-primary via-secondary to-accent"></div>
	
	<div class='flex flex-col my-4 justify-between h-full relative z-10'>
		<div>
			<!-- Profile Section -->
			<div class='flex justify-center items-center flex-col mb-8'>
				<div class="group relative w-40 h-40">
					<!-- Animated gradient ring -->
					<div class="absolute inset-0 bg-gradient-to-br from-primary via-secondary to-accent rounded-full p-1 transition-all duration-300 group-hover:scale-110">
						<div class="w-full h-full bg-base-200 rounded-full p-1">
							<img
								class='mask mask-circle w-full h-full object-cover transition-all duration-300 group-hover:scale-105'
								src={profilePicture}
								alt={`Profile picture of ${fullName}`}
							/>
						</div>
					</div>
					<!-- Glow effect -->
					<div class="absolute inset-0 bg-gradient-to-br from-primary/30 via-secondary/30 to-accent/30 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300 blur-xl -z-10"></div>
				</div>
				<h1 class="text-xl font-bold mt-6 hidden lg:block bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent transition-all duration-300 hover:scale-105">{fullName}</h1>
			</div>

			<!-- Navigation Menu -->
			<div class='mx-2'>
				<ul class='space-y-3 menu grow shrink menu-md overflow-y-auto'>
					{navigationItems.map((item, index) => (
						<li>
							<a href={item.href} class={`group relative overflow-hidden rounded-xl bg-gradient-to-r from-transparent via-transparent to-transparent p-3 text-base font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg hover:from-primary/10 hover:via-secondary/10 hover:to-accent/10 active:scale-95`}>
								<div class="flex items-center space-x-3 relative z-10">
									<svg class="w-5 h-5 transition-all duration-300 group-hover:scale-110 group-hover:text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
										<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d={item.icon}></path>
									</svg>
									<span class="transition-all duration-300 group-hover:text-primary">{item.label}</span>
								</div>
								<!-- Hover background effect -->
								<div class="absolute inset-0 bg-gradient-to-r from-primary/20 via-secondary/20 to-accent/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl"></div>
								<!-- Active border indicator -->
								<div class="absolute left-0 top-0 h-full w-1 bg-gradient-to-b from-primary to-secondary opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-r"></div>
							</a>
						</li>
					))}
				</ul>
			</div>
		</div>
		
		<!-- Social Icons Section -->
		<div class='mx-4 mt-8'>
			<div class="bg-base-300/50 backdrop-blur-sm rounded-2xl p-4 border border-base-300/50 transition-all duration-300 hover:bg-base-300/70 hover:border-base-300/80">
				<SocialIcons/>
			</div>
		</div>
	</div>
</aside>
